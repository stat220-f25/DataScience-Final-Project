---
title: "Final Portfolio Project"
author: "Seth Bonney and Cuong Tran"
format: pdf
geometry: margin=0.75in
---

## Research Question

Will come up soon

```{r}
#| echo: false
#| message: false
#| warning: false

library(tidyverse)
library(janitor)
library(broom)

# Import data

sleep_raw   <- read_csv("Sleep_health_and_lifestyle_dataset.csv")
student_raw <- read_csv("Student_Performance.csv")
factors_raw <- read_csv("StudentPerformanceFactors.csv")

# Clean Sleep dataset
sleep <- sleep_raw |>
  clean_names() |>
  select(
    sleep_duration,              
    sleep_quality = quality_of_sleep,
    stress_level,
    age,
    gender
  ) |>
  drop_na(sleep_duration, sleep_quality, stress_level)

# Create sleep categories
sleep <- sleep |>
  mutate(
    sleep_category = case_when(
      sleep_duration < 7 ~ "Short sleep",
      sleep_duration >= 7 & sleep_duration <= 9 ~ "Recommended sleep",
      sleep_duration > 9 ~ "Long sleep"
    ),
    sleep_category = factor(
      sleep_category,
      levels = c("Short sleep", "Recommended sleep", "Long sleep")
    )
  )

# Clean Student Performance dataset
student <- student_raw |>
  clean_names()

student <- student |>
  select(
    performance_index,
    previous_scores,
    hours_studied,
    sleep_hours
  ) |>
  drop_na(performance_index, previous_scores, hours_studied)

# Clean Student Performance Factors dataset
factors <- factors_raw |>
  clean_names()

# We keep only useful columns; adjust based on actual names
factors <- factors |>
  select(
    study_hours = hours_studied,     
    score = previous_scores,
    sleep_hours = sleep_hours
  ) |>
  drop_na()

# Create a JOINED dataset
# JOIN LOGIC: join by sleep hours 

# STEP 1: link sleep + student performance via sleep duration
sleep_student <- student |>
  left_join(
    sleep |> 
      select(sleep_duration, sleep_quality, stress_level, sleep_category),
    by = join_by(sleep_hours == sleep_duration)
  )

# STEP 2: link in study factors
full_data <- sleep_student |>
  left_join(
    factors,
    by = join_by(sleep_hours)
  )

# Summary Tables

sleep_summary <- sleep |>
  summarise(
    mean_sleep   = mean(sleep_duration),
    median_sleep = median(sleep_duration),
    sd_sleep     = sd(sleep_duration),
    mean_quality = mean(sleep_quality),
    mean_stress  = mean(stress_level)
  )

student_summary <- student |>
  summarise(
    mean_grade   = mean(performance_index),
    median_grade = median(performance_index),
    mean_prev    = mean(previous_scores),
    mean_study   = mean(hours_studied)
  )

# Correlation matrices

sleep_cor <- sleep |> select(where(is.numeric)) |> cor()
student_cor <- student |> select(where(is.numeric)) |> cor()

glimpse(sleep_cor)
glimpse(student_cor)

```
